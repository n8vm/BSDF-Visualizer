<!DOCTYPE html>
<html>
	<header>
		<title>BSDF Visualizer - CS6635 </title>
		<link rel="stylesheet" href="./Styles/flexbox.css">
		<link rel="stylesheet" href="./Styles/fonts.css">
		<link rel="stylesheet" href="./Styles/colors.css">
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
	</header>
	<body id="main-container">
    <script src="Scripts/hsvToRgb.js"></script>
    <script src="Scripts/gl-matrix.js"></script>

    <script type="vertex" id="phong.vert">
        #version 300 es
        
        layout (location=0) in vec4 model_position;
        layout (location=1) in vec3 color;
        layout (location=2) in vec4 model_normal;

        uniform mat4 u_m;
        uniform mat4 u_v;
        uniform mat4 u_p;
        
        out vec3 vColor;
        //out vec4 world_position;
        out vec4 world_normal;

        void main() {
            vColor = color;
            gl_Position = u_p * u_v * u_m * model_position;
            //world_position = u_m * model_position;
            world_normal = u_m * model_normal;
        }
    </script>
    <script type="fragment" id="phong.frag">
        #version 300 es

        precision highp float;
        
        //uniform vec3 u_world_light_pos; 

        //float k_a = 0.1;
        //float k_d = 0.9;

        in vec3 vColor;
        //in vec4 world_position; 
        in vec4 world_normal; 

        out vec4 fragColor;

        void main() {
            vec3 norm = normalize(world_normal.xyz);
            //vec3 to_light = normalize((u_world_light_pos.xyz - world_position.xyz)); 
            //fragColor = k_a*vColor + k_d*dot(norm, to_light)*vColor;
            //fragColor = 0.01 * norm + 0.99 * vColor;
            vec3 final_color = 0.99 * norm + 0.01 * vColor;  
            fragColor = vec4(final_color, 1.0); 
        }
    </script>

    <!-- Old shader below, color only -->
    <script type="vertex" id="vs">
        #version 300 es
        
        layout (location=0) in vec4 position;
        layout (location=1) in vec3 color;

        //uniform mat4 u_mvp;
        uniform mat4 u_m;
        uniform mat4 u_v;
        uniform mat4 u_p;
        
        out vec3 vColor;

        void main() {
            vColor = color;
            gl_PointSize = 10.0;
            gl_Position = u_p * u_v * u_m * position;
        }
    </script>
    <script type="fragment" id="fs">
        #version 300 es
        precision highp float;
        
        in vec3 vColor;
        out vec4 fragColor;

        void main() {
            fragColor = vec4(vColor, 1.0);
        }
    </script>

    <canvas id="webgl-canvas"></canvas>
    <script type="application/javascript" src="Scripts/main.js">
    </script>
	</body>
</html>
